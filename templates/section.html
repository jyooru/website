{% extends "index.html" %}

{% block title %}{{ config.title }}/{{ section.title }}{% endblock %}

{% block content %}
<h1>{{ section.title }}</h1>

{{ section.content | safe }}

<ul>
  {% set items = section.pages %}
  {% for path in section.subsections %}
  {% set_global items = items | concat(with=get_section(path=path)) %}
  {% endfor %}

  {% for item in items | sort(attribute="title") %}
  <li>
    {% set link = item.permalink %}
    {% if item.extra.href is defined %}
    {% set link = item.extra.href %}
    {% endif %}
    <b><a href="{{ link }}">{{ item.title }}</a></b>

    {% if item.extra is defined %}
    <br>
    <span class="alt">
      {% set display_order = ["using", "stars"] %}

      {% set_global to_display = [] %}
      {% for key in display_order %}
      {% if item.extra is containing(key) %}

      {% set value = item.extra | get(key=key) %}

      {% if value | int(default=1) <= 0 %}
      {% continue %}
      {% endif %}

      {% if key == "using" %}
      {% set value = "Built using " ~ value %}
      {% else %}
      {% if value is number and value == 1 %}{% set key = key | trim_end_matches(pat="s") %}{% endif %}
      {% set value = value ~ " " ~ key %}
      {% endif %}

      {% set_global to_display = to_display | concat(with=[value]) %}
      {% endif %}
      {% endfor %}

      {{ to_display | join(sep=", ")}}
    </span>
    {% endif %}

    {% if item.description is defined %}<p>{{ item.description }}</p>{% endif %}

  </li>
  {% endfor %}
</ul>
{% endblock %}
